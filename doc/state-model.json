{
    "$schema": "http://json-schema.org/draft-06/schema#",
    "$ref": "#/definitions/StateModel",
    "definitions": {
        "StateModel": {
            "title": "StateModel",
            "description": "ReShare state model definition",
            "type": "object",
            "additionalProperties": false,
            "properties": {
                "type": {
                    "type": "string",
                    "const": "StateModel"
                },
                "name": {
                    "type": "string",
                    "description": "Name of the state model"
                },
                "desc": {
                    "type": "string",
                    "description": "Description of the state model (e.g what workflow is defined)"
                },
                "version": {
                    "type": "string",
                    "description": "Version of the state model in SemVer"
                },
                "states": {
                    "type": "array",
                    "description": "A list of all allowed states",
                    "items": {
                        "$ref": "#/definitions/State"
                    }
                }
            },
            "required": [
                "desc",
                "name",
                "states",
                "type",
                "version"
            ]
        },
        "State": {
            "type": "object",
            "additionalProperties": false,
            "properties": {
                "name": {
                    "type": "string",
                    "description": "Name of the state, use capital letters with underscores"
                },
                "display": {
                    "type": "string",
                    "description": "Human-readable name displayed to user"
                },
                "desc": {
                    "type": "string",
                    "description": "Description of the state, e.g what situation is modelled by the state"
                },
                "actions": {
                    "type": "array",
                    "description": "List of all actions that cane be performed on the request when in this state",
                    "items": {
                        "$ref": "#/definitions/Action"
                    }
                },
                "terminal": {
                    "type": "boolean",
                    "description": "Indicates if the state is terminal (meaning no actions are allowed when in the state) or not"
                }
            },
            "oneOf": [
                {
                    "required": [
                        "actions"
                    ]
                },
                {
                    "required": [
                        "terminal"
                    ]
                }
            ],
            "required": [
                "desc",
                "display",
                "name"
            ],
            "title": "State"
        },
        "Action": {
            "type": "object",
            "additionalProperties": false,
            "properties": {
                "name": {
                    "type": "string",
                    "description": "Name of the action"
                },
                "trigger": {
                    "type": "string",
                    "description": "Type of the action trigger: [MANUAL, PROTOCOL, SYSTEM]",
                    "enum": ["MANUAL", "PROTOCOL", "SYSTEM"],
                    "default": "MANUAL"
                },
                "desc": {
                    "type": "string",
                    "description": "Description of the action"
                },
                "transitions": {
                    "type": "array",
                    "description": "List of all possible state transitions after performing the action",
                    "items": {
                        "type": "string"
                    }
                }
            },
            "required": [
                "desc",
                "name"
            ],
            "title": "Action"
        }
    }
}
